# セキュリティポリシー

## サポートされているバージョン

以下のバージョンでセキュリティ更新を提供しています：

| バージョン | サポート状況 |
| ------- | ----------- |
| 1.0.x   | ✅ 完全サポート |
| 0.9.x   | ⚠️ 重要な修正のみ |
| < 0.9   | ❌ サポート終了 |

## セキュリティ脆弱性の報告

JavaSSGプロジェクトはセキュリティを重視しており、脆弱性の迅速な対応に努めています。

### 🚨 緊急度の高い脆弱性

以下の脆弱性を発見した場合は、**公開のIssue tracker を使用せず**、直接私たちに連絡してください：

- リモートコード実行（RCE）
- SQLインジェクション
- クロスサイトスクリプティング（XSS）
- 認証バイパス
- 権限昇格
- 機密情報の漏洩

### 📧 報告方法

**セキュリティ脆弱性の報告先：**
- **Email**: security@javassg.org
- **件名**: `[SECURITY] 脆弱性報告: [簡潔な説明]`

### 📝 報告テンプレート

```markdown
## 脆弱性の概要
[脆弱性の簡潔な説明]

## 影響度
- [ ] 重大 (Critical)
- [ ] 高 (High)  
- [ ] 中 (Medium)
- [ ] 低 (Low)

## 影響範囲
[どのコンポーネント/機能が影響を受けるか]

## 攻撃シナリオ
[攻撃者がこの脆弱性をどのように悪用できるか]

## 再現手順
1. [ステップ1]
2. [ステップ2]
3. [ステップ3]

## 期待される結果
[正常な動作の説明]

## 実際の結果
[実際に起こる問題の説明]

## 環境情報
- OS: [例: macOS 14.0]
- Java: [例: OpenJDK 21.0.1]
- JavaSSG: [例: 1.0.0]

## 追加情報
[スクリーンショット、ログ、その他の関連情報]

## 提案される修正
[可能であれば、修正方法の提案]
```

### 🔒 責任ある開示

私たちは**責任ある開示**ポリシーに従います：

1. **報告受領**: 24時間以内に受領確認をお送りします
2. **初期評価**: 72時間以内に脆弱性の評価を行います
3. **修正開発**: 重要度に応じて修正版を開発します
4. **テスト**: 修正版の十分なテストを実施します
5. **リリース**: セキュリティ修正版をリリースします
6. **公開**: 修正後、適切な期間を置いて詳細を公開します

### ⏱️ 対応時間の目安

| 重要度 | 初期対応 | 修正リリース |
|--------|----------|--------------|
| 重大 | 24時間以内 | 7日以内 |
| 高 | 72時間以内 | 30日以内 |
| 中 | 1週間以内 | 90日以内 |
| 低 | 2週間以内 | 次回リリース |

## 🛡️ セキュリティ機能

JavaSSGは以下のセキュリティ機能を提供しています：

### 入力検証とサニタイゼーション

#### XSS攻撃防止
- 危険なHTMLタグの検出・除去（`<script>`, `<iframe>`, `<object>`, `<embed>`）
- 40以上のHTMLイベントハンドラーの検出
- マルチライン攻撃パターンの検出
- 大文字小文字混在攻撃の対応

#### パストラバーサル攻撃防止
- ファイルパスの厳密な検証
- 相対パス攻撃の防止（`../`, `..\\`）
- Windows予約名の検出（CON, PRN, AUX等）
- 制御文字の検出

#### YAML/設定ファイルの安全性
- 危険なYAMLタグの検出（`!!python/object`等）
- ファイルサイズ制限
- フロントマターサイズ制限

### アクセス制御

#### ファイルシステム保護
- 許可されたファイル拡張子のみ処理
- 隠しファイルの処理制限
- セキュアなファイルパーミッション

#### メモリ保護
- メモリ使用量の制限
- ストリーミング処理による効率的なメモリ管理
- ガベージコレクション最適化

### セキュリティヘッダー

開発サーバーは以下のセキュリティヘッダーを設定します：

```http
X-Content-Type-Options: nosniff
X-Frame-Options: DENY
X-XSS-Protection: 1; mode=block
Content-Security-Policy: default-src 'self'
Referrer-Policy: strict-origin-when-cross-origin
```

## 🔍 セキュリティ監査

### 定期監査

- **コード監査**: 四半期ごとの包括的なコードレビュー
- **依存関係監査**: 月次の脆弱性スキャン
- **ペネトレーションテスト**: 年2回の外部監査

### 自動化されたセキュリティチェック

- **SAST**: 静的アプリケーションセキュリティテスト
- **依存関係スキャン**: 既知の脆弱性チェック
- **ライセンススキャン**: オープンソースライセンスの確認

## 📋 セキュリティチェックリスト

### 開発者向け

新機能開発時は以下を確認してください：

#### 入力検証
- [ ] すべての外部入力を検証している
- [ ] ファイルパスの検証を実装している
- [ ] ファイルサイズ制限を適用している
- [ ] 文字エンコーディングを適切に処理している

#### 出力エスケープ
- [ ] HTMLコンテンツを適切にエスケープしている
- [ ] URLを安全に生成している
- [ ] JSONレスポンスを適切に処理している

#### エラーハンドリング
- [ ] 機密情報をエラーメッセージに含めていない
- [ ] 適切なログレベルを使用している
- [ ] スタックトレースの漏洩を防いでいる

#### アクセス制御
- [ ] ファイルアクセス権限を適切に設定している
- [ ] 一時ファイルを安全に処理している
- [ ] ディレクトリトラバーサルを防いでいる

### 設定セキュリティ

#### 本番環境設定
```yaml
# セキュリティ強化設定例
limits:
  maxMarkdownFileSize: 5242880      # 5MB（本番では制限を厳しく）
  maxConfigFileSize: 524288         # 512KB
  maxFrontMatterSize: 50000         # 50KB
  maxFilenameLength: 200            # ファイル名制限
  maxTitleLength: 100               # タイトル制限
  maxDescriptionLength: 300         # 説明文制限

security:
  strictValidation: true            # 厳密な検証を有効
  sanitizeOutput: true              # 出力のサニタイゼーション
  logSecurityEvents: true           # セキュリティイベントのログ
```

## 🏆 セキュリティ貢献者の認定

セキュリティ向上に貢献いただいた方々：

- **Hall of Fame**: 重要な脆弱性を報告いただいた方々
- **セキュリティアドバイザー**: 継続的なセキュリティ向上に貢献

### 報告の謝礼

重要度に応じて以下の謝礼を提供しています：

- **重大**: 公式認定 + プロジェクトへの永続的クレジット
- **高**: 公式認定 + リリースノートでの言及
- **中・低**: リリースノートでの感謝


## 🔗 関連リソース

### セキュリティガイドライン
- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [CWE/SANS Top 25](https://cwe.mitre.org/top25/)
- [Java Security Guidelines](https://docs.oracle.com/en/java/javase/21/security/)

### JavaSSG固有のセキュリティドキュメント
- [セキュアな設定ガイド](docs/security-configuration.md)
- [カスタムプラグインのセキュリティ](docs/plugin-security.md)
- [セキュリティベストプラクティス](docs/security-best-practices.md)

---

**セキュリティは私たち全員の責任です。** 疑問や懸念がある場合は、遠慮なくご連絡ください。
